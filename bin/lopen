#!/usr/bin/env bash
# shellcheck source=../lib/functions.inc.sh
source "$(dirname "$0")"/../lib/functions.inc

### END FRONTMATTER ###
set -e

help() {
  echo "$(basename "$0") [options] <file>"
  echo "  -h   help"
  echo "  -m   print mimetype"
}

f=${!#}
a=$(echo "${@%$f}" | tr -d "[:blank:]-")

[[ $a =~ h ]] && help && exit 0
[[ $a =~ m ]] && SHOW_MIMETYPE=true && OPEN=false

if ${SHOW_MIMETYPE}; then
  if [[ "$(input_type "$f")" =~ "file" ]]; then
    mimetype $f
  fi
fi

if ${OPEN}; then
  case $(input_type "$f") in
    file) open_file "$f" ;;
    *)    open_url "$f" ;;
  esac
fi
