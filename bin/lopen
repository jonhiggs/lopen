#!/usr/bin/env bash
source $(dirname $0)/../lib/functions.inc

### END FRONTMATTER ###
set -e

open_url() {
  local p
  p=$(echo "$1" | awk -F: '{ print $1 }') in
  case $p in
    http|https) ${BROWSER} "$1" ;;
    *) echo "Unsupported protocol '$p'." ;;
  esac
}

open_file() {
  local file
  local mimetype

  file=$(unwrap_file "$1")
  mimetype=$(mimetype "${file}")

  case ${mimetype} in
    'text/markdown') get_command ${mimetype} ;;
    *) echo "Unsupported mimetype '${mimetype}'." ;;
  esac
}

case $(input_type "$1") in
  file) open_file "$1" ;;
  *)    open_url "$1" ;;
esac
